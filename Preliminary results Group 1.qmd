---
title: "Variables over time per species"
format: html
editor: visual
---

```{r}
# Load the data
load("data/bound-data.Rdata")

# Load necessary libraries
library(dplyr)
library(ggplot2)

# Convert Week to a factor
datab$Week1 <- as.factor(datab$Week)

datab$Species[datab$Species=="Amaranthus retroflexus "] <- "Amaranthus retroflexus" 
```

Plant height

```{r}
# Group by Species, Treatment, and Week and calculate mean plant height
meanheight_byweeks <- datab %>%
  group_by(Species, Treatment, Week) %>%
  summarise(Mean_plant_height = mean(Plant_height))

# Create a ggplot with facets for each species
ggplot(meanheight_byweeks, aes(x = Week, y = Mean_plant_height, color = Treatment, group = Treatment)) +
  geom_point() +
  geom_line() +
  theme_bw() +
  facet_wrap(~Species, scales = "free_y")+
labs(title = "Mean Plant Height Over Weeks",
       x = "Week",
       y = "Mean Plant Height") +
  theme(legend.position = "top", legend.box.background = element_rect(colour = "black")) # Facet by Species with free y-axis scales

```

Soil humidity

```{r}
# Group by Species, Treatment, and Week and calculate mean soil humidity
meanhumidity_byweeks <- datab %>%
  group_by(Species, Treatment, Week) %>%
  summarise(Mean_soil_humidity = mean(Soil_humidity))

# Create a ggplot with facets for each species
ggplot(meanhumidity_byweeks, aes(x = Week, y = Mean_soil_humidity, color = Treatment, group = Treatment)) +
  geom_point() +
  geom_line() +
  theme_bw() +
  facet_wrap(~Species, scales = "free_y")+  # Facet by Species with free y-axis scales
labs(title = "Mean Soil Humidity Over Weeks",
       x = "Week",
       y = "Mean Soil Humidity") +
  theme(legend.position = "top", legend.box.background = element_rect(colour = "black"))
```

Leaf_length

```{r}
# Group by Species, Treatment, and Week and calculate mean plant height
meanllength_byweeks <- datab %>%
  group_by(Species, Treatment, Week) %>%
  summarise(Mean_leaf_length = mean(Leaf_length))

# Create a ggplot with facets for each species
ggplot(meanllength_byweeks, aes(x = Week, y = Mean_leaf_length, color = Treatment, group = Treatment)) +
  geom_point() +
  geom_line() +
  theme_bw() +
  facet_wrap(~Species, scales = "free_y")+
  labs(title = "Mean Leaf Length Over Weeks",
       x = "Week",
       y = "Mean Leaf Length") +
  theme(legend.position = "top", legend.box.background = element_rect(colour = "black"))# Facet by Species with free y-axis scales
```
Statistical analysis
```{r}
library(agricolae)

datab$Soil_humidity <- as.numeric(datab$Soil_humidity)

st.sh <- datab %>%
  filter(!is.na(Soil_humidity)) %>%
  group_by(Species,Treatment,Week) %>%
  summarise(Mean.Soil.Humidity = mean(Soil_humidity),
            Median.Soil.Humidity = median(Soil_humidity),
            Variance.Soil.Humidity = var(Soil_humidity),
            Standard.Deviation.Soil.Humidity = sd(Soil_humidity))

datab <- tidyr::separate(datab,PlantId, c("sptr"), sep=3)

an <- aov(formula = datab$Plant_height ~ datab$sptr)
an
hsd <- TukeyHSD(an)
hsd
```

```

